#N canvas 106 53 1174 629 10;
#X obj 274 80 inlet~;
#X obj 394 80 inlet;
#X obj 394 237 s \$0-play;
#X obj 444 212 s \$0-record;
#X obj 494 189 s \$0-stop;
#N canvas 0 22 450 278 (subpatch) 0;
#X array \$0-buffer 115584 float 0 black #ffffff;
#X coords 0 0.1 115583 -0.1 195 139 1;
#X restore 57 96 graph;
#N canvas 74 26 1084 682.094 record 0;
#X obj 34 86 inlet~;
#X obj 60 127 r \$0-record;
#X obj 186 263 timer;
#X msg 90 226 stop;
#X obj 60 159 t b b;
#X obj 186 301 outlet;
#X text 33 58 audio in;
#X text 118 57 Receives for record and stop;
#X text 184 334 recorded time output;
#X text 349 18 FIXME: implement cyclical recording;
#X text 228 301 ms;
#X obj 145 127 r \$0-stoprecord;
#X obj 34 263 tabwrite~ \$0-recbuffer;
#X obj 325 332 array-copypart \$0-recbuffer \$0-buffer;
#X obj 145 159 t b b;
#X floatatom 344 312 7 0 0 0 - - -, f 7;
#X obj 325 290 looplength \$0-recbuffer;
#X text 349 66 FEATURE: record from current play position;
#X text 349 83 FEATURE: overdubbing;
#X text 349 49 Features to consider;
#X text 326 262 copy data from recording buffer to play buffer;
#X connect 0 0 12 0;
#X connect 1 0 4 0;
#X connect 2 0 5 0;
#X connect 2 0 16 0;
#X connect 3 0 12 0;
#X connect 4 0 12 0;
#X connect 4 1 2 0;
#X connect 11 0 14 0;
#X connect 14 0 3 0;
#X connect 14 1 2 1;
#X connect 16 0 15 0;
#X connect 16 0 13 0;
#X restore 274 128 pd record;
#N canvas 294 28 897 727.031 play 0;
#X obj 239 572 outlet~;
#X obj 239 63 r \$0-play;
#X obj 239 282 phasor~;
#X obj 239 422 tabread4~ \$0-buffer;
#X obj 337 63 r \$0-stop;
#X msg 337 121 0;
#X obj 303 484 loadbang;
#X msg 303 513 1;
#X obj 278 456 r \$0-anticlick;
#X obj 239 543 softgate~ 3;
#X obj 516 63 inlet;
#X obj 457 63 inlet;
#X obj 457 121 f 0.002;
#X obj 516 121 f 0.999;
#X obj 577 63 loadbang;
#X obj 577 92 t b b;
#X obj 457 150 t f f;
#X obj 516 150 t f f;
#X text 429 17 Loop start;
#X text 516 16 Loop end;
#N canvas 0 22 450 300.031 phase_to_position 0;
#X obj 44 117 inlet~;
#X obj 130 116 inlet;
#X text 129 85 Array size;
#X text 44 85 Phase;
#X obj 44 193 *~;
#X obj 44 252 outlet~;
#X obj 105 156 - 3;
#X obj 44 221 +~ 1;
#X text 48 24 Convert phase to position in the array;
#X text 100 194 Indices should range from 1 to array size minus 2;
#X connect 0 0 4 0;
#X connect 1 0 6 0;
#X connect 4 0 7 0;
#X connect 6 0 4 1;
#X connect 7 0 5 0;
#X restore 239 386 pd phase_to_position;
#X obj 254 169 r \$0-length;
#X obj 299 313 reset_phase~;
#X obj 368 351 t f;
#X obj 446 574 outlet;
#X obj 31 458 s \$0-length;
#X obj 239 249 f;
#X floatatom 274 226 5 0 0 0 - - -, f 5;
#X msg 239 120 bang;
#X floatatom 286 361 5 0 0 0 - - -, f 5;
#X obj 414 342 r \$0-length;
#X obj 31 71 r \$0-recordlength;
#X floatatom 41 101 8 0 0 0 - - -, f 8;
#X text 31 39 calculate loop length;
#X text 457 45 phase;
#X text 515 45 phase;
#X text 141 71 ms;
#X floatatom 419 373 7 0 0 0 - - -, f 7;
#X text 105 458 samples;
#X text 485 342 samples;
#X text 326 169 samples;
#X obj 254 200 samtofreq;
#X text 215 405 sam;
#X text 463 546 current phase;
#X obj 31 175 looplength \$0-recbuffer;
#X floatatom 139 300 6 0 0 0 - - -, f 6;
#X connect 1 0 28 0;
#X connect 2 0 20 0;
#X connect 2 0 22 0;
#X connect 3 0 9 0;
#X connect 4 0 5 0;
#X connect 5 0 2 0;
#X connect 6 0 7 0;
#X connect 7 0 9 1;
#X connect 8 0 9 1;
#X connect 9 0 0 0;
#X connect 10 0 13 0;
#X connect 11 0 12 0;
#X connect 12 0 16 0;
#X connect 13 0 17 0;
#X connect 14 0 15 0;
#X connect 15 0 12 0;
#X connect 15 1 13 0;
#X connect 16 0 22 1;
#X connect 17 0 22 2;
#X connect 20 0 3 0;
#X connect 21 0 41 0;
#X connect 22 1 24 0;
#X connect 22 1 29 0;
#X connect 22 2 23 0;
#X connect 23 0 2 1;
#X connect 26 0 2 0;
#X connect 28 0 26 0;
#X connect 30 0 20 1;
#X connect 30 0 37 0;
#X connect 31 0 32 0;
#X connect 31 0 44 0;
#X connect 41 0 27 0;
#X connect 41 0 26 0;
#X connect 44 0 25 0;
#X connect 44 0 45 0;
#X restore 383 449 pd play;
#X obj 383 540 outlet~;
#X obj 656 80 inlet;
#X obj 709 80 inlet;
#X obj 448 540 outlet;
#X text 274 39 audio in;
#X text 394 39 control in;
#X text 656 39 loop start;
#X text 733 39 loop end;
#X text 383 570 audio out;
#X obj 274 165 s \$0-recordlength;
#X obj 394 128 select play record stop stoprecord;
#X obj 544 165 s \$0-stoprecord;
#N canvas 0 22 450 300 (subpatch) 0;
#X array \$0-recbuffer 441000 float 0 black #ffffff;
#X coords 0 0.1 440999 -0.1 200 140 1;
#X restore 56 475 graph;
#X obj 57 255 hsl 190 15 0 1 0 0 \$0-tmp \$0-phase empty -2 -8 0 10
-1 -262144 -1 18463 1;
#X text 448 570 current phase;
#X obj 448 491 s \$0-phase;
#X obj 57 81 hsl 190 15 0 1 0 0 \$0-loopstart \$0-HSstart empty -2
-8 0 10 -83221 -208051 -262144 1300 1;
#X obj 61 402 s \$0-HSstart;
#X obj 167 402 s \$0-HSend;
#X obj 57 235 hsl 190 15 0 1 0 0 \$0-loopend \$0-HSend empty -2 -8
0 10 -83221 -208051 -262144 18710 1;
#X obj 656 121 minmax;
#X msg 61 372 set \$1;
#X msg 167 372 set \$1;
#X obj 602 540 outlet;
#X obj 703 540 outlet;
#X obj 656 196 s \$0-loopstart;
#X obj 709 166 s \$0-loopend;
#X obj 61 342 r \$0-loopstart;
#X obj 167 342 r \$0-loopend;
#X obj 383 370 r \$0-loopstart;
#X obj 448 410 r \$0-loopend;
#X obj 602 506 r \$0-loopstart;
#X obj 703 506 r \$0-loopend;
#X text 599 570 for controlling external values;
#X text 90 318 slider control block;
#X text 423 329 player;
#X connect 0 0 6 0;
#X connect 1 0 18 0;
#X connect 6 0 17 0;
#X connect 7 0 8 0;
#X connect 7 1 11 0;
#X connect 7 1 23 0;
#X connect 9 0 28 0;
#X connect 10 0 28 1;
#X connect 18 0 2 0;
#X connect 18 1 3 0;
#X connect 18 2 4 0;
#X connect 18 3 19 0;
#X connect 28 0 33 0;
#X connect 28 1 34 0;
#X connect 29 0 25 0;
#X connect 30 0 26 0;
#X connect 35 0 29 0;
#X connect 36 0 30 0;
#X connect 37 0 7 0;
#X connect 38 0 7 1;
#X connect 39 0 31 0;
#X connect 40 0 32 0;
#X coords 0 -1 1 1 200 200 1 54 79;
